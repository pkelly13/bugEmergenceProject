#Bar plot figure of either absolute concnetration of fatty acids, or % fatty acids depending on how much of the tsGrowth_and_PCAplots script is run. Source the scrip to run % of total FAs
#PTK 11 June 2014

#set working directory
setwd('~/bugEmergenceProject')
#source script
source('tsGrowth_and_PCAplots.R')

#save plot as a pdf to potential figures folder
setwd('~/bugEmergenceProject/potential figures')

pdf('fattyAcidTrophicTransfer_barplot.pdf',width=11,height=8.5)
par(mfrow=c(2,2))
table=epa.table
se.table=se.epa.table
barplot(table,beside=T,ylim=c(0,max(se.table+table)),main='EPA',legend=c('Seston','Insects','Bolus','Nestlings'),args.legend=list(x=6.5,y=14,cex=1,bty='n')) 
error.bar(1.5,table[1,1],upper=se.table[1,1],lower=0,length=0.04)
error.bar(2.5,table[2,1],upper=se.table[2,1],lower=0,length=0.04)
error.bar(3.5,table[3,1],upper=se.table[3,1],lower=0,length=0.04)
error.bar(4.5,table[4,1],upper=se.table[4,1],lower=0,length=0.04)
error.bar(6.5,table[1,2],upper=se.table[1,2],lower=0,length=0.04)
error.bar(7.5,table[2,2],upper=se.table[2,2],lower=0,length=0.04)
error.bar(8.5,table[3,2],upper=se.table[3,2],lower=0,length=0.04)
error.bar(9.5,table[4,2],upper=se.table[4,2],lower=0,length=0.04)
error.bar(11.5,table[1,3],upper=se.table[1,3],lower=0,length=0.04)
error.bar(12.5,table[2,3],upper=se.table[2,3],lower=0,length=0.04)
error.bar(13.5,table[3,3],upper=se.table[3,3],lower=0,length=0.04)
error.bar(14.5,table[4,3],upper=se.table[4,3],lower=0,length=0.04)
error.bar(16.5,table[1,4],upper=se.table[1,4],lower=0,length=0.04)
error.bar(17.5,table[2,4],upper=se.table[2,4],lower=0,length=0.04)
error.bar(18.5,table[3,4],upper=se.table[3,4],lower=0,length=0.04)
error.bar(19.5,table[4,4],upper=se.table[4,4],lower=0,length=0.04)
error.bar(21.5,table[1,5],upper=se.table[1,5],lower=0,length=0.04)
error.bar(22.5,table[2,5],upper=se.table[2,5],lower=0,length=0.04)
error.bar(23.5,table[3,5],upper=se.table[3,5],lower=0,length=0.04)
error.bar(24.5,table[4,5],upper=se.table[4,5],lower=0,length=0.04)
error.bar(26.5,table[1,6],upper=se.table[1,6],lower=0,length=0.04)
error.bar(27.5,table[2,6],upper=se.table[2,6],lower=0,length=0.04)
error.bar(28.5,table[3,6],upper=se.table[3,6],lower=0,length=0.04)
error.bar(29.5,table[4,6],upper=se.table[4,6],lower=0,length=0.04)



table<-dha.table
se.table<-se.dha.table
barplot(table,beside=T,ylim=c(0,max(se.table+table)),main='DHA') 
error.bar(1.5,table[1,1],upper=se.table[1,1],lower=0,length=0.04)
error.bar(2.5,table[2,1],upper=se.table[2,1],lower=0,length=0.04)
error.bar(3.5,table[3,1],upper=se.table[3,1],lower=0,length=0.04)
error.bar(4.5,table[4,1],upper=se.table[4,1],lower=0,length=0.04)
error.bar(6.5,table[1,2],upper=se.table[1,2],lower=0,length=0.04)
error.bar(7.5,table[2,2],upper=se.table[2,2],lower=0,length=0.04)
error.bar(8.5,table[3,2],upper=se.table[3,2],lower=0,length=0.04)
error.bar(9.5,table[4,2],upper=se.table[4,2],lower=0,length=0.04)
error.bar(11.5,table[1,3],upper=se.table[1,3],lower=0,length=0.04)
error.bar(12.5,table[2,3],upper=se.table[2,3],lower=0,length=0.04)
error.bar(13.5,table[3,3],upper=se.table[3,3],lower=0,length=0.04)
error.bar(14.5,table[4,3],upper=se.table[4,3],lower=0,length=0.04)
error.bar(16.5,table[1,4],upper=se.table[1,4],lower=0,length=0.04)
error.bar(17.5,table[2,4],upper=se.table[2,4],lower=0,length=0.04)
error.bar(18.5,table[3,4],upper=se.table[3,4],lower=0,length=0.04)
error.bar(19.5,table[4,4],upper=se.table[4,4],lower=0,length=0.04)
error.bar(21.5,table[1,5],upper=se.table[1,5],lower=0,length=0.04)
error.bar(22.5,table[2,5],upper=se.table[2,5],lower=0,length=0.04)
error.bar(23.5,table[3,5],upper=se.table[3,5],lower=0,length=0.04)
error.bar(24.5,table[4,5],upper=se.table[4,5],lower=0,length=0.04)
error.bar(26.5,table[1,6],upper=se.table[1,6],lower=0,length=0.04)
error.bar(27.5,table[2,6],upper=se.table[2,6],lower=0,length=0.04)
error.bar(28.5,table[3,6],upper=se.table[3,6],lower=0,length=0.04)
error.bar(29.5,table[4,6],upper=se.table[4,6],lower=0,length=0.04)


table<-w3.table
se.table<-se.w3.table
barplot(table,beside=T,ylim=c(0,max(se.table+table)),main=expression(paste(omega,'3'))) 
error.bar(1.5,table[1,1],upper=se.table[1,1],lower=0,length=0.04)
error.bar(2.5,table[2,1],upper=se.table[2,1],lower=0,length=0.04)
error.bar(3.5,table[3,1],upper=se.table[3,1],lower=0,length=0.04)
error.bar(4.5,table[4,1],upper=se.table[4,1],lower=0,length=0.04)
error.bar(6.5,table[1,2],upper=se.table[1,2],lower=0,length=0.04)
error.bar(7.5,table[2,2],upper=se.table[2,2],lower=0,length=0.04)
error.bar(8.5,table[3,2],upper=se.table[3,2],lower=0,length=0.04)
error.bar(9.5,table[4,2],upper=se.table[4,2],lower=0,length=0.04)
error.bar(11.5,table[1,3],upper=se.table[1,3],lower=0,length=0.04)
error.bar(12.5,table[2,3],upper=se.table[2,3],lower=0,length=0.04)
error.bar(13.5,table[3,3],upper=se.table[3,3],lower=0,length=0.04)
error.bar(14.5,table[4,3],upper=se.table[4,3],lower=0,length=0.04)
error.bar(16.5,table[1,4],upper=se.table[1,4],lower=0,length=0.04)
error.bar(17.5,table[2,4],upper=se.table[2,4],lower=0,length=0.04)
error.bar(18.5,table[3,4],upper=se.table[3,4],lower=0,length=0.04)
error.bar(19.5,table[4,4],upper=se.table[4,4],lower=0,length=0.04)
error.bar(21.5,table[1,5],upper=se.table[1,5],lower=0,length=0.04)
error.bar(22.5,table[2,5],upper=se.table[2,5],lower=0,length=0.04)
error.bar(23.5,table[3,5],upper=se.table[3,5],lower=0,length=0.04)
error.bar(24.5,table[4,5],upper=se.table[4,5],lower=0,length=0.04)
error.bar(26.5,table[1,6],upper=se.table[1,6],lower=0,length=0.04)
error.bar(27.5,table[2,6],upper=se.table[2,6],lower=0,length=0.04)
error.bar(28.5,table[3,6],upper=se.table[3,6],lower=0,length=0.04)
error.bar(29.5,table[4,6],upper=se.table[4,6],lower=0,length=0.04)

table=pufa.table
se.table=se.pufa.table
barplot(pufa.table,beside=T,ylim=c(0,max(se.pufa.table+pufa.table)),main='PUFA') 
error.bar(1.5,table[1,1],upper=se.table[1,1],lower=0,length=0.04)
error.bar(2.5,table[2,1],upper=se.table[2,1],lower=0,length=0.04)
error.bar(3.5,table[3,1],upper=se.table[3,1],lower=0,length=0.04)
error.bar(4.5,table[4,1],upper=se.table[4,1],lower=0,length=0.04)
error.bar(6.5,table[1,2],upper=se.table[1,2],lower=0,length=0.04)
error.bar(7.5,table[2,2],upper=se.table[2,2],lower=0,length=0.04)
error.bar(8.5,table[3,2],upper=se.table[3,2],lower=0,length=0.04)
error.bar(9.5,table[4,2],upper=se.table[4,2],lower=0,length=0.04)
error.bar(11.5,table[1,3],upper=se.table[1,3],lower=0,length=0.04)
error.bar(12.5,table[2,3],upper=se.table[2,3],lower=0,length=0.04)
error.bar(13.5,table[3,3],upper=se.table[3,3],lower=0,length=0.04)
error.bar(14.5,table[4,3],upper=se.table[4,3],lower=0,length=0.04)
error.bar(16.5,table[1,4],upper=se.table[1,4],lower=0,length=0.04)
error.bar(17.5,table[2,4],upper=se.table[2,4],lower=0,length=0.04)
error.bar(18.5,table[3,4],upper=se.table[3,4],lower=0,length=0.04)
error.bar(19.5,table[4,4],upper=se.table[4,4],lower=0,length=0.04)
error.bar(21.5,table[1,5],upper=se.table[1,5],lower=0,length=0.04)
error.bar(22.5,table[2,5],upper=se.table[2,5],lower=0,length=0.04)
error.bar(23.5,table[3,5],upper=se.table[3,5],lower=0,length=0.04)
error.bar(24.5,table[4,5],upper=se.table[4,5],lower=0,length=0.04)
error.bar(26.5,table[1,6],upper=se.table[1,6],lower=0,length=0.04)
error.bar(27.5,table[2,6],upper=se.table[2,6],lower=0,length=0.04)
error.bar(28.5,table[3,6],upper=se.table[3,6],lower=0,length=0.04)
error.bar(29.5,table[4,6],upper=se.table[4,6],lower=0,length=0.04)


mtext('Site',side=1,cex=1.4,line=-1.5,outer=T)
mtext('% of total FAs',side=2,cex=1.4,line=-1.5,outer=T)
dev.off()